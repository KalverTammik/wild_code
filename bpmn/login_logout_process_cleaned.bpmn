<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:open-bpmn="http://open-bpmn.org/XMLSchema" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="18.6.1" id="Definitions_WildCodeLoginLogout" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:extensionElements>
    <open-bpmn:auto-align/>
  </bpmn:extensionElements>
  <bpmn:process id="WildCodeLoginLogoutProcess" isExecutable="true" processType="Public">
    <bpmn:documentation id="documentation_0i71ig"/>
    <bpmn:startEvent id="StartEvent" name="Start Plugin">
      <bpmn:documentation id="documentation_HGf57A"/>
      <bpmn:outgoing>Flow_LoadSession</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:scriptTask id="Task_LoadSession" name="Load Session">
      <bpmn:documentation>SessionManager.load() loads session data from QSettings.</bpmn:documentation>
      <bpmn:incoming>Flow_LoadSession</bpmn:incoming>
      <bpmn:outgoing>Flow_CheckSessionValid</bpmn:outgoing>
      <bpmn:script/>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_SessionValid" name="Is Session Valid?">
      <bpmn:documentation>SessionManager.revalidateSession() checks if the session is valid and not expired.</bpmn:documentation>
      <bpmn:incoming>Flow_CheckSessionValid</bpmn:incoming>
      <bpmn:outgoing>Flow_SessionValid</bpmn:outgoing>
      <bpmn:outgoing>Flow_SessionInvalid</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:task id="Task_OpenPluginDialog" name="Open PluginDialog">
      <bpmn:documentation>Show PluginDialog if session is valid and user is logged in.</bpmn:documentation>
      <bpmn:incoming>Flow_SessionValid</bpmn:incoming>
      <bpmn:incoming>Flow_LoginSuccess</bpmn:incoming>
      <bpmn:incoming>Flow_1scgdsl</bpmn:incoming>
      <bpmn:outgoing>Flow_PluginDialogOpen</bpmn:outgoing>
    </bpmn:task>
    <bpmn:task id="Task_OpenLoginDialog" name="Open LoginDialog">
      <bpmn:documentation>Show LoginDialog if session is invalid or user is not logged in.</bpmn:documentation>
      <bpmn:incoming>Flow_SessionInvalid</bpmn:incoming>
      <bpmn:incoming>Flow_Logout</bpmn:incoming>
      <bpmn:outgoing>Flow_UserInput</bpmn:outgoing>
    </bpmn:task>
    <bpmn:userTask id="Task_UserInput" name="User Enters Credentials">
      <bpmn:documentation>User enters username and password in LoginDialog.</bpmn:documentation>
      <bpmn:incoming>Flow_UserInput</bpmn:incoming>
      <bpmn:outgoing>Flow_ValidateCredentials</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:scriptTask id="Task_ValidateCredentials" name="Validate Credentials">
      <bpmn:documentation>Check credentials (mock API call or real API in production).</bpmn:documentation>
      <bpmn:incoming>Flow_ValidateCredentials</bpmn:incoming>
      <bpmn:outgoing>Flow_CredentialsValid</bpmn:outgoing>
      <bpmn:script/>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_CredentialsValid" name="Are Credentials Valid?">
      <bpmn:documentation>Decision: Are the credentials correct?</bpmn:documentation>
      <bpmn:incoming>Flow_CredentialsValid</bpmn:incoming>
      <bpmn:outgoing>Flow_LoginSuccess</bpmn:outgoing>
      <bpmn:outgoing>Flow_RetryLogin</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Task_SetSession" name="Set Session">
      <bpmn:documentation>SessionManager.setSession() saves the session and user info.</bpmn:documentation>
      <bpmn:incoming>Flow_LoginSuccess</bpmn:incoming>
      <bpmn:outgoing>Flow_OpenPluginDialogAfterLogin</bpmn:outgoing>
      <bpmn:script/>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_LoadSession" sourceRef="StartEvent" targetRef="Task_LoadSession">
      <bpmn:documentation>Start plugin triggers session load.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_CheckSessionValid" sourceRef="Task_LoadSession" targetRef="Gateway_SessionValid">
      <bpmn:documentation>After loading session, check if session is valid.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_SessionValid" name="Valid" sourceRef="Gateway_SessionValid" targetRef="Task_OpenPluginDialog">
      <bpmn:documentation>Session is valid and user is logged in.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_SessionInvalid" name="Invalid" sourceRef="Gateway_SessionValid" targetRef="Task_OpenLoginDialog">
      <bpmn:documentation>Session is invalid or expired, open LoginDialog.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_UserInput" sourceRef="Task_OpenLoginDialog" targetRef="Task_UserInput">
      <bpmn:documentation>User is prompted to enter credentials.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_ValidateCredentials" sourceRef="Task_UserInput" targetRef="Task_ValidateCredentials">
      <bpmn:documentation>Validate the entered credentials.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_CredentialsValid" sourceRef="Task_ValidateCredentials" targetRef="Gateway_CredentialsValid">
      <bpmn:documentation>Decision: Are credentials valid?</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_LoginSuccess" name="Yes" sourceRef="Gateway_CredentialsValid" targetRef="Task_SetSession">
      <bpmn:documentation>Credentials are valid, set session and proceed.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_RetryLogin" name="No" sourceRef="Gateway_CredentialsValid" targetRef="Task_UserInput">
      <bpmn:documentation>Credentials invalid, prompt user to try again.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_OpenPluginDialogAfterLogin" sourceRef="Task_SetSession" targetRef="Gateway_PluginDialogOpen">
      <bpmn:documentation>After setting session, open PluginDialog.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_PluginDialogOpen" sourceRef="Task_OpenPluginDialog" targetRef="Gateway_PluginDialogOpen">
      <bpmn:documentation>PluginDialog is open, user can interact or logout.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:parallelGateway id="Gateway_PluginDialogOpen" name="PluginDialog Open">
      <bpmn:documentation>User can either close the dialog or logout.</bpmn:documentation>
      <bpmn:incoming>Flow_PluginDialogOpen</bpmn:incoming>
      <bpmn:incoming>Flow_OpenPluginDialogAfterLogin</bpmn:incoming>
      <bpmn:outgoing>Flow_UserLogout</bpmn:outgoing>
      <bpmn:outgoing>Flow_UserCloseDialog</bpmn:outgoing>
      <bpmn:outgoing>Flow_1scgdsl</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:userTask id="Task_UserLogout" name="User Clicks Logout">
      <bpmn:documentation>User clicks the logout button in PluginDialog.</bpmn:documentation>
      <bpmn:incoming>Flow_UserLogout</bpmn:incoming>
      <bpmn:outgoing>Flow_Logout</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_UserLogout" sourceRef="Gateway_PluginDialogOpen" targetRef="Task_UserLogout">
      <bpmn:documentation>User chooses to logout.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:scriptTask id="Task_ClearSession" name="Clear Session">
      <bpmn:documentation>SessionManager.clear() clears session and persistent storage.</bpmn:documentation>
      <bpmn:incoming>Flow_Logout</bpmn:incoming>
      <bpmn:outgoing>Flow_OpenLoginAfterLogout</bpmn:outgoing>
      <bpmn:script/>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="Flow_Logout" sourceRef="Task_UserLogout" targetRef="Task_ClearSession">
      <bpmn:documentation>After logout, clear session.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_OpenLoginAfterLogout" sourceRef="Task_ClearSession" targetRef="EndEvent">
      <bpmn:documentation>After clearing session, show LoginDialog again.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Task_UserCloseDialog" name="User Closes PluginDialog">
      <bpmn:documentation>User closes the PluginDialog window (not a logout).</bpmn:documentation>
      <bpmn:incoming>Flow_UserCloseDialog</bpmn:incoming>
      <bpmn:outgoing>Flow_End</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="Flow_UserCloseDialog" sourceRef="Gateway_PluginDialogOpen" targetRef="Task_UserCloseDialog">
      <bpmn:documentation>User closes the PluginDialog window.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:endEvent id="EndEvent" name="End">
      <bpmn:documentation id="documentation_0zkzdg"/>
      <bpmn:incoming>Flow_End</bpmn:incoming>
      <bpmn:incoming>Flow_OpenLoginAfterLogout</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_End" sourceRef="Task_UserCloseDialog" targetRef="EndEvent">
      <bpmn:documentation>Process ends when user closes PluginDialog.</bpmn:documentation>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1scgdsl" sourceRef="Gateway_PluginDialogOpen" targetRef="Task_OpenPluginDialog">
      <bpmn:documentation id="documentation_hFvBdA"/>
    </bpmn:sequenceFlow>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="WildCodeLoginLogoutDiagram">
    <bpmndi:BPMNPlane bpmnElement="WildCodeLoginLogoutProcess" id="WildCodeLoginLogoutPlane">
      <bpmndi:BPMNShape bpmnElement="Gateway_SessionValid" id="Shape_Gateway_SessionValid" isMarkerVisible="true">
        <dc:Bounds height="50" width="50" x="410" y="190"/>
        <bpmndi:BPMNLabel id="BPMNLabel_QYz0VQ">
          <dc:Bounds height="14" width="84" x="393" y="243"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_OpenLoginDialog" id="Shape_Task_OpenLoginDialog">
        <dc:Bounds height="50" width="120" x="510" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_UserInput" id="Shape_Task_UserInput">
        <dc:Bounds height="50" width="120" x="670" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_ValidateCredentials" id="Shape_Task_ValidateCredentials">
        <dc:Bounds height="50" width="120" x="830" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_CredentialsValid" id="Shape_Gateway_CredentialsValid" isMarkerVisible="true">
        <dc:Bounds height="50" width="50" x="990" y="250"/>
        <bpmndi:BPMNLabel id="BPMNLabel_0fw79w">
          <dc:Bounds height="27" width="76" x="977" y="212.5"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="EndEvent" id="Shape_EndEvent">
        <dc:Bounds height="36" width="36" x="1530" y="102"/>
        <bpmndi:BPMNLabel id="BPMNLabel_3UyShw">
          <dc:Bounds height="14" width="20" x="1538" y="78"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_SetSession" id="Shape_Task_SetSession">
        <dc:Bounds height="50" width="120" x="1080" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_LoadSession" id="Shape_Task_LoadSession">
        <dc:Bounds height="50" width="120" x="250" y="190"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="StartEvent" id="Shape_StartEvent">
        <dc:Bounds height="36" width="36" x="170" y="197"/>
        <bpmndi:BPMNLabel id="BPMNLabel_eWnGRQ">
          <dc:Bounds height="14" width="57" x="160" y="236"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_UserLogout" id="Shape_Task_UserLogout">
        <dc:Bounds height="50" width="120" x="1280" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_UserCloseDialog" id="Shape_Task_UserCloseDialog">
        <dc:Bounds height="50" width="120" x="1370" y="95"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_ClearSession" id="Shape_Task_ClearSession">
        <dc:Bounds height="50" width="120" x="1488" y="250"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Gateway_PluginDialogOpen" id="Shape_Gateway_PluginDialogOpen" isMarkerVisible="true">
        <dc:Bounds height="50" width="50" x="1225" y="155"/>
        <bpmndi:BPMNLabel id="BPMNLabel_7HFaYg">
          <dc:Bounds height="27" width="62" x="1149" y="127.5"/>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="Task_OpenPluginDialog" id="Shape_Task_OpenPluginDialog">
        <dc:Bounds height="50.0" width="120.0" x="905.0" y="94.0"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="Flow_LoadSession" id="Edge_Flow_LoadSession">
        <di:waypoint x="206.0" y="215.0"/>
        <di:waypoint x="250.0" y="215.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_CheckSessionValid" id="Edge_Flow_CheckSessionValid">
        <di:waypoint x="370.0" y="215.0"/>
        <di:waypoint x="410.0" y="215.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_SessionValid" id="Edge_Flow_SessionValid">
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="23" x="489" y="153"/>
        </bpmndi:BPMNLabel>
        <di:waypoint x="460.0" y="215.0"/>
        <di:waypoint x="485.0" y="215.0"/>
        <di:waypoint x="485.0" y="119.0"/>
        <di:waypoint x="905.0" y="119.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_SessionInvalid" id="Edge_Flow_SessionInvalid">
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="32" x="484" y="235"/>
        </bpmndi:BPMNLabel>
        <di:waypoint x="460.0" y="215.0"/>
        <di:waypoint x="485.0" y="215.0"/>
        <di:waypoint x="485.0" y="275.0"/>
        <di:waypoint x="510.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_UserInput" id="Edge_Flow_UserInput">
        <di:waypoint x="630.0" y="275.0"/>
        <di:waypoint x="670.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_ValidateCredentials" id="Edge_Flow_ValidateCredentials">
        <di:waypoint x="790.0" y="275.0"/>
        <di:waypoint x="830.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_CredentialsValid" id="Edge_Flow_CredentialsValid">
        <di:waypoint x="950.0" y="275.0"/>
        <di:waypoint x="990.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_LoginSuccess" id="Edge_Flow_LoginSuccess">
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="18" x="1054" y="283"/>
        </bpmndi:BPMNLabel>
        <di:waypoint x="1040.0" y="275.0"/>
        <di:waypoint x="1080.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_RetryLogin" id="Edge_Flow_RetryLogin">
        <bpmndi:BPMNLabel>
          <dc:Bounds height="14" width="15" x="866" y="315"/>
        </bpmndi:BPMNLabel>
        <di:waypoint x="1015.0" y="300.0"/>
        <di:waypoint x="1015.0" y="340.0"/>
        <di:waypoint x="730.0" y="340.0"/>
        <di:waypoint x="730.0" y="300.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_OpenPluginDialogAfterLogin" id="Edge_Flow_OpenPluginDialogAfterLogin">
        <di:waypoint x="1200.0" y="275.0"/>
        <di:waypoint x="1250.0" y="275.0"/>
        <di:waypoint x="1250.0" y="205.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_PluginDialogOpen" id="Edge_Flow_PluginDialogOpen">
        <di:waypoint x="965.0" y="144.0"/>
        <di:waypoint x="965.0" y="180.0"/>
        <di:waypoint x="1225.0" y="180.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_UserLogout" id="Edge_Flow_UserLogout">
        <di:waypoint x="1275.0" y="180.0"/>
        <di:waypoint x="1340.0" y="180.0"/>
        <di:waypoint x="1340.0" y="250.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_Logout" id="Edge_Flow_Logout">
        <di:waypoint x="1400.0" y="275.0"/>
        <di:waypoint x="1488.0" y="275.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_OpenLoginAfterLogout" id="Edge_Flow_OpenLoginAfterLogout">
        <di:waypoint x="1548.0" y="250.0"/>
        <di:waypoint x="1548.0" y="138.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_UserCloseDialog" id="Edge_Flow_UserCloseDialog">
        <di:waypoint x="1275.0" y="180.0"/>
        <di:waypoint x="1340.0" y="180.0"/>
        <di:waypoint x="1340.0" y="120.0"/>
        <di:waypoint x="1370.0" y="120.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_End" id="Edge_Flow_End">
        <di:waypoint x="1490.0" y="120.0"/>
        <di:waypoint x="1530.0" y="120.0"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="Flow_1scgdsl" id="Flow_1scgdsl_di">
        <di:waypoint x="1250.0" y="155.0"/>
        <di:waypoint x="1250.0" y="119.0"/>
        <di:waypoint x="1025.0" y="119.0"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
