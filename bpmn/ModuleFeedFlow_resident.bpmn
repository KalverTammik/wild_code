<?xml version="1.0" encoding="utf-8"?>
<ns0:definitions xmlns:ns0="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:ns1="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:ns2="http://www.omg.org/spec/DD/20100524/DC" xmlns:ns3="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:ns4="http://www.omg.org/spec/DD/20100524/DI" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Defs_ModuleFeed_Resident" targetNamespace="https://example.local/bpmn/module-feed/resident" exporter="ChatGPT BPMN Mapper" exporterVersion="1.1">
  <ns0:collaboration id="Collab_Plugin">
    <ns0:participant id="Participant_Plugin" name="QGIS Plugin" processRef="Process_ModuleFeed_Resident"/>
  </ns0:collaboration>
  <ns0:process id="Process_ModuleFeed_Resident" name="Module Feed (Resident Model)" isExecutable="false">
    <ns0:laneSet id="LaneSet_Main">
      <ns0:lane id="Lane_User" name="User / ScrollBar"/>
      <ns0:lane id="Lane_ModuleBaseUI" name="ModuleBaseUI / Module UIs">
        <ns0:flowNodeRef>Start_Activated</ns0:flowNodeRef>
        <ns0:flowNodeRef>Task_Init</ns0:flowNodeRef>
        <ns0:flowNodeRef>Gateway_HasFeedEngine</ns0:flowNodeRef>
        <ns0:flowNodeRef>SubProcess_Legacy</ns0:flowNodeRef>
        <ns0:flowNodeRef>Task_ActiveIdle</ns0:flowNodeRef>
      </ns0:lane>
      <ns0:lane id="Lane_FeedLoadEngine" name="FeedLoadEngine"/>
      <ns0:lane id="Lane_FeedLogic" name="FeedLogic"/>
      <ns0:lane id="Lane_ModuleFeedBuilder" name="ModuleFeedBuilder"/>
      <ns0:lane id="Lane_ThemeManager" name="ThemeManager"/>
    </ns0:laneSet>
    <ns0:startEvent id="Start_Activated" name="Module activated"/>
    <ns0:task id="Task_Init" name="Init feed engine &amp; connect scroll handlers"/>
    <ns0:exclusiveGateway id="Gateway_HasFeedEngine" name="Has FeedLoadEngine?"/>
    <ns0:subProcess id="SubProcess_Legacy" name="LEGACY PATH: Inline load &amp; insert (to be removed)" triggeredByEvent="false">
      <ns0:startEvent id="Legacy_Start" name="Legacy start"/>
  <ns0:task id="Legacy_AddItemsToFeed" name="(REMOVED) add_items_to_feed shim"/>
      <ns0:task id="Legacy_AutofillScrollArea" name="autofill_scroll_area()"/>
      <ns0:task id="Legacy_ProgressiveInsertInline" name="_progressive_insert_card(item) inline"/>
      <ns0:endEvent id="Legacy_End" name="Legacy done"/>
      <ns0:sequenceFlow id="Legacy_F1" sourceRef="Legacy_Start" targetRef="Legacy_AddItemsToFeed"/>
      <ns0:sequenceFlow id="Legacy_F2" sourceRef="Legacy_AddItemsToFeed" targetRef="Legacy_AutofillScrollArea"/>
      <ns0:sequenceFlow id="Legacy_F3" sourceRef="Legacy_AutofillScrollArea" targetRef="Legacy_ProgressiveInsertInline"/>
      <ns0:sequenceFlow id="Legacy_F4" sourceRef="Legacy_ProgressiveInsertInline" targetRef="Legacy_End"/>
    </ns0:subProcess>
    <ns0:task id="Task_ActiveIdle" name="ACTIVE: waiting for events (resident)"/>
    <ns0:sequenceFlow id="Flow_1" sourceRef="Start_Activated" targetRef="Task_Init"/>
    <ns0:sequenceFlow id="Flow_2" sourceRef="Task_Init" targetRef="Gateway_HasFeedEngine"/>
    <ns0:sequenceFlow id="Flow_3a" sourceRef="Gateway_HasFeedEngine" targetRef="SubProcess_Legacy" name="No"/>
    <ns0:sequenceFlow id="Flow_3b" sourceRef="Gateway_HasFeedEngine" targetRef="Task_ActiveIdle" name="Yes"/>
    <ns0:sequenceFlow id="Flow_4" sourceRef="SubProcess_Legacy" targetRef="Task_ActiveIdle"/>
    <ns0:subProcess id="ESP_ScrollOrTimer" name="Event SubProcess: Scroll/Timer â†’ Progressive insert" triggeredByEvent="true">
      <ns0:startEvent id="Start_Scroll" name="Scroll.valueChanged" isInterrupting="false">
        <ns0:messageEventDefinition/>
      </ns0:startEvent>
      <ns0:startEvent id="Start_Timer" name="Drip timer" isInterrupting="false">
        <ns0:timerEventDefinition/>
      </ns0:startEvent>
      <ns0:exclusiveGateway id="A_Gateway_NearBottom" name="Near bottom?"/>
      <ns0:task id="A_Task_BufferDrip" name="engine._progressive_insert_next()"/>
      <ns0:task id="A_Task_ScheduleLoad" name="engine.schedule_load()"/>
      <ns0:task id="A_Task_LoadGuard" name="engine._load_next_batch_guarded()"/>
      <ns0:task id="A_Task_FetchNextBatch" name="feed_logic.fetch_next_batch()"/>
      <ns0:task id="A_Task_BufferExtend" name="engine.buffer.extend(items)"/>
      <ns0:task id="A_Task_StartProg" name="engine._start_progressive_insert()"/>
      <ns0:task id="A_Task_UIProgressiveInsert" name="ui._progressive_insert_card(item)"/>
      <ns0:endEvent id="A_End_CycleDone" name="Cycle done"/>
      <ns0:sequenceFlow id="A_F0" sourceRef="Start_Scroll" targetRef="A_Gateway_NearBottom"/>
      <ns0:sequenceFlow id="A_F0b" sourceRef="Start_Timer" targetRef="A_Gateway_NearBottom"/>
      <ns0:sequenceFlow id="A_F1" sourceRef="A_Gateway_NearBottom" targetRef="A_Task_BufferDrip" name="buffer&gt;0 &amp; visible&lt;MAX"/>
      <ns0:sequenceFlow id="A_F2" sourceRef="A_Task_BufferDrip" targetRef="A_Task_UIProgressiveInsert"/>
      <ns0:sequenceFlow id="A_F3" sourceRef="A_Gateway_NearBottom" targetRef="A_Task_ScheduleLoad" name="else"/>
      <ns0:sequenceFlow id="A_F4" sourceRef="A_Task_ScheduleLoad" targetRef="A_Task_LoadGuard"/>
      <ns0:sequenceFlow id="A_F5" sourceRef="A_Task_LoadGuard" targetRef="A_Task_FetchNextBatch"/>
      <ns0:sequenceFlow id="A_F6" sourceRef="A_Task_FetchNextBatch" targetRef="A_Task_BufferExtend"/>
      <ns0:sequenceFlow id="A_F7" sourceRef="A_Task_BufferExtend" targetRef="A_Task_StartProg"/>
      <ns0:sequenceFlow id="A_F8" sourceRef="A_Task_StartProg" targetRef="A_Task_UIProgressiveInsert"/>
      <ns0:sequenceFlow id="A_F9" sourceRef="A_Task_UIProgressiveInsert" targetRef="A_End_CycleDone"/>
    </ns0:subProcess>
    <ns0:subProcess id="ESP_Deactivation" name="Event SubProcess: Module Deactivated (terminate)" triggeredByEvent="true">
      <ns0:startEvent id="Start_ModuleDeactivated" name="ModuleDeactivated" isInterrupting="true">
        <ns0:messageEventDefinition/>
      </ns0:startEvent>
      <ns0:endEvent id="End_Terminate" name="Terminate">
        <ns0:terminateEventDefinition/>
      </ns0:endEvent>
      <ns0:sequenceFlow id="B_F1" sourceRef="Start_ModuleDeactivated" targetRef="End_Terminate"/>
    </ns0:subProcess>
  </ns0:process>
  <ns1:BPMNDiagram id="BPMNDiagram_Resident">
    <ns1:BPMNPlane id="BPMNPlane_Resident" bpmnElement="Collab_Plugin">
      <ns1:BPMNShape id="ParticipantShape_Plugin" bpmnElement="Participant_Plugin">
        <ns2:Bounds x="80" y="40" width="3400" height="520"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_User" bpmnElement="Lane_User" isHorizontal="true">
        <ns2:Bounds x="80" y="60.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_ModuleBaseUI" bpmnElement="Lane_ModuleBaseUI" isHorizontal="true">
        <ns2:Bounds x="80" y="140.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_FeedLoadEngine" bpmnElement="Lane_FeedLoadEngine" isHorizontal="true">
        <ns2:Bounds x="80" y="220.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_FeedLogic" bpmnElement="Lane_FeedLogic" isHorizontal="true">
        <ns2:Bounds x="80" y="300.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_ModuleFeedBuilder" bpmnElement="Lane_ModuleFeedBuilder" isHorizontal="true">
        <ns2:Bounds x="80" y="380.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="LaneShape_Lane_ThemeManager" bpmnElement="Lane_ThemeManager" isHorizontal="true">
        <ns2:Bounds x="80" y="460.0" width="3400" height="80.0"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Start_Activated" bpmnElement="Start_Activated">
        <ns2:Bounds x="120" y="80" width="40" height="40"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Task_Init" bpmnElement="Task_Init">
        <ns2:Bounds x="220" y="70" width="180" height="60"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Gateway_HasFeedEngine" bpmnElement="Gateway_HasFeedEngine">
        <ns2:Bounds x="430" y="85" width="50" height="50"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_SubProcess_Legacy" bpmnElement="SubProcess_Legacy">
        <ns2:Bounds x="540" y="190" width="520" height="210"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Legacy_Start" bpmnElement="Legacy_Start" ns3:stroke="#cc0000" ns3:fill="#ffe6e6">
        <ns2:Bounds x="560" y="210" width="30" height="30"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Legacy_AddItemsToFeed" bpmnElement="Legacy_AddItemsToFeed" ns3:stroke="#cc0000" ns3:fill="#ffe6e6">
        <ns2:Bounds x="610" y="200" width="160" height="50"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Legacy_AutofillScrollArea" bpmnElement="Legacy_AutofillScrollArea" ns3:stroke="#cc0000" ns3:fill="#ffe6e6">
        <ns2:Bounds x="800" y="200" width="160" height="50"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Legacy_ProgressiveInsertInline" bpmnElement="Legacy_ProgressiveInsertInline" ns3:stroke="#cc0000" ns3:fill="#ffe6e6">
        <ns2:Bounds x="990" y="200" width="160" height="50"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Legacy_End" bpmnElement="Legacy_End" ns3:stroke="#cc0000" ns3:fill="#ffe6e6">
        <ns2:Bounds x="1110" y="210" width="30" height="30"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_Task_ActiveIdle" bpmnElement="Task_ActiveIdle">
        <ns2:Bounds x="540" y="70" width="180" height="60"/>
      </ns1:BPMNShape>
      <ns1:BPMNEdge id="Edge_Flow_1" bpmnElement="Flow_1">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Flow_2" bpmnElement="Flow_2">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Flow_3a" bpmnElement="Flow_3a" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Flow_3b" bpmnElement="Flow_3b">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Flow_4" bpmnElement="Flow_4" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Legacy_F1" bpmnElement="Legacy_F1" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Legacy_F2" bpmnElement="Legacy_F2" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Legacy_F3" bpmnElement="Legacy_F3" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNEdge id="Edge_Legacy_F4" bpmnElement="Legacy_F4" ns3:stroke="#cc0000">
        <ns4:waypoint x="0" y="0"/>
        <ns4:waypoint x="0" y="0"/>
      </ns1:BPMNEdge>
      <ns1:BPMNShape id="Shape_ESP_ScrollOrTimer" bpmnElement="ESP_ScrollOrTimer">
        <ns2:Bounds x="1080" y="320" width="1120" height="200"/>
      </ns1:BPMNShape>
      <ns1:BPMNShape id="Shape_ESP_Deactivation" bpmnElement="ESP_Deactivation">
        <ns2:Bounds x="2240" y="320" width="480" height="140"/>
      </ns1:BPMNShape>
    </ns1:BPMNPlane>
  </ns1:BPMNDiagram>
</ns0:definitions>
